!function(){"use strict";function t(){}function e(t,e){for(var i in e)t[i]=e[i];return t}function i(t,e,i){t.insertBefore(e,i)}function s(t){t.parentNode.removeChild(t)}function r(t){return document.createElement(t)}function n(){return Object.create(null)}function a(t){t._lock=!0,o(t._beforecreate),o(t._oncreate),o(t._aftercreate),t._lock=!1}function o(t){for(;t&&t.length;)t.shift()()}var u={destroy:function(e){this.destroy=t,this.fire("destroy"),this.set=t,this._fragment.d(!1!==e),this._fragment=null,this._state={}},get:function(){return this._state},fire:function(t,e){var i=t in this._handlers&&this._handlers[t].slice();if(i)for(var s=0;s<i.length;s+=1){var r=i[s];if(!r.__calling)try{r.__calling=!0,r.call(this,e)}finally{r.__calling=!1}}},on:function(t,e){var i=this._handlers[t]||(this._handlers[t]=[]);return i.push(e),{cancel:function(){var t=i.indexOf(e);~t&&i.splice(t,1)}}},set:function(t){this._set(e({},t)),this.root._lock||a(this.root)},_recompute:t,_set:function(t){var i=this._state,s={},r=!1;for(var n in t=e(this._staged,t),this._staged={},t)this._differs(t[n],i[n])&&(s[n]=r=!0);r&&(this._state=e(e({},i),t),this._recompute(s,this._state),this._bind&&this._bind(s,this._state),this._fragment&&(this.fire("state",{changed:s,current:this._state,previous:i}),this._fragment.p(s,this._state),this.fire("update",{changed:s,current:this._state,previous:i})))},_stage:function(t){e(this._staged,t)},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_differs:function(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}};function h({environment:t,organisationDomain:e,userAvatarEndpoint:i,uuid:s,region:r}){if(e){let t=`https://${e}${i.V2}`;return s?t.replace("-",s):t}{let e=((t,e)=>{const i={qa:"https://qa1.fid.freshworksapi.com",staging:"https://staging.fid.freshworksapi.com",production:"https://api.freshworks.com"},s={eu:"https://eu.api.freshworks.com",au:"https://au.api.freshworks.com",in:"https://in.api.freshworks.com"};let r=t,n="";-1===Object.keys(i).indexOf(t)&&(r="production"),n=i[r],e&&"production"===r&&-1!==Object.keys(s).indexOf(e)&&(n=s[e]);return n})(t,r)+i.V1;return s&&(e+=`/${s}`),e}}function l({changed:t,current:e,previous:i}){if((t.width||t.environment||t.uuid||t.organisationDomain||t.region)&&i){const t=this.refs.image;if(t){const{fallbackImageUrl:e,imageParams:i,apiEndpoint:s}=this.get();t.onload=(()=>{this.visible=!0}),t.onerror=(()=>{t.setAttribute("src",`//${e}`),t.onerror=(()=>{})}),t.setAttribute("src",`${s}${i}`)}}}function c(t,e){var n,a;return{c(){(n=r("img")).width=e.width,n.className=a="freshworks-user-avatar "+(e.visible?"visible":"")+" "+(e.round?"round":""),n.alt=e.altText},m(e,s){i(e,n,s),t.refs.image=n},p(t,e){t.width&&(n.width=e.width),(t.visible||t.round)&&a!==(a="freshworks-user-avatar "+(e.visible?"visible":"")+" "+(e.round?"round":""))&&(n.className=a),t.altText&&(n.alt=e.altText)},d(e){e&&s(n),t.refs.image===n&&(t.refs.image=null)}}}class d extends HTMLElement{constructor(a={}){var o,u,h,d,f;super(),function(t,e){t._handlers=n(),t._slots=n(),t._bind=e._bind,t._staged={},t.options=e,t.root=e.root||t,t.store=e.store||t.root.store,e.root||(t._beforecreate=[],t._oncreate=[],t._aftercreate=[])}(this,a),this.refs={},this._state=e({width:null,environment:null,userAvatarEndpoint:{V1:"/api/v1/profile/image",V2:"/api/v2/users/-/image"},size:"tiny",fallbackImageUrl:"accounts.freshworks.com/freshworks-components/assets/images/default-avatar.svg",altText:"Your User Avatar",round:!1,visible:!1,uuid:null,organisationDomain:null,region:null},a.data),this._recompute({width:1,size:1,organisationDomain:1,environment:1,userAvatarEndpoint:1,uuid:1,region:1},this._state),this._intro=!0,this._handlers.update=[l],this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML="<style>.freshworks-user-avatar-wrapper{display:inline-block;background-color:whitesmoke}.freshworks-user-avatar-wrapper.visible{background-color:transparent}.freshworks-user-avatar{display:none}.freshworks-user-avatar.visible{display:inline-block}.freshworks-user-avatar.round{border-radius:50%}</style>",this._fragment=(o=this,u=this._state,f=u.width&&c(o,u),{c(){h=r("span"),f&&f.c(),this.c=t,h.className=d="freshworks-user-avatar-wrapper "+(u.visible?"visible":"")},m(t,e){i(t,h,e),f&&f.m(h,null),o.refs.wrapper=h},p(t,e){e.width?f?f.p(t,e):((f=c(o,e)).c(),f.m(h,null)):f&&(f.d(1),f=null),t.visible&&d!==(d="freshworks-user-avatar-wrapper "+(e.visible?"visible":""))&&(h.className=d)},d(t){t&&s(h),f&&f.d(),o.refs.wrapper===h&&(o.refs.wrapper=null)}}),this.root._oncreate.push(()=>{(function(){const{width:t}=this.get(),e=this.dataset.width;this.refs.wrapper.setAttribute("style",`width: ${e}px; height: ${e}px;`),customElements.whenDefined("freshworks-user-avatar").then(()=>{document.querySelectorAll("freshworks-user-avatar").forEach(t=>{Object.entries(t.dataset).forEach(([e,i])=>{Object.keys(this.get()).includes(e)&&(t[e]=i)})})})}).call(this),this.fire("update",{changed:function(t,e){for(var i in e)t[i]=1;return t}({},this._state),current:this._state})}),this._fragment.c(),this._fragment.m(this.shadowRoot,null),a.target&&this._mount(a.target,a.anchor)}static get observedAttributes(){return["width","size","organisationDomain","environment","userAvatarEndpoint","uuid","region","visible","round","altText"]}get width(){return this.get().width}set width(t){this.set({width:t})}get size(){return this.get().size}set size(t){this.set({size:t})}get organisationDomain(){return this.get().organisationDomain}set organisationDomain(t){this.set({organisationDomain:t})}get environment(){return this.get().environment}set environment(t){this.set({environment:t})}get userAvatarEndpoint(){return this.get().userAvatarEndpoint}set userAvatarEndpoint(t){this.set({userAvatarEndpoint:t})}get uuid(){return this.get().uuid}set uuid(t){this.set({uuid:t})}get region(){return this.get().region}set region(t){this.set({region:t})}get visible(){return this.get().visible}set visible(t){this.set({visible:t})}get round(){return this.get().round}set round(t){this.set({round:t})}get altText(){return this.get().altText}set altText(t){this.set({altText:t})}attributeChangedCallback(t,e,i){this.set({[t]:i})}connectedCallback(){a(this)}}e(d.prototype,u),e(d.prototype,{_mount(t,e){t.insertBefore(this,e)}}),customElements.define("freshworks-user-avatar",d),d.prototype._recompute=function(t,e){(t.width||t.size||t.organisationDomain)&&this._differs(e.imageParams,e.imageParams=function({width:t,size:e,organisationDomain:i}){if(!t)return;const s={16:"TINY",24:"THUMBNAIL",48:"SMALL",96:"MEDIUM",256:"LARGE"};let r;const n=Object.keys(s).some(e=>parseInt(t,10)<=parseInt(e,10)&&(r=e,!0));return`?${`${i?"variant":"size"}=${r=n?s[r]:"ORIGINAL"}`}`}(e))&&(t.imageParams=!0),(t.environment||t.organisationDomain||t.userAvatarEndpoint||t.uuid||t.region)&&this._differs(e.apiEndpoint,e.apiEndpoint=h(e))&&(t.apiEndpoint=!0)}}();
